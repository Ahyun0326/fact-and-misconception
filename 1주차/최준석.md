# 객체지향의 사실과 오해 1-2장 정리

## 1장: 협력하는 객체들의 공동체

### 1.1 협력하는 사람들

커피숍에서 손님, 캐시어, 바리스타가 협력하는 과정이 객체지향의 핵심을 보여준다:

- 각자 명확한 **역할**과 **책임**을 가짐
- **메시지**를 통해서만 상호작용
- 서로의 내부 구현은 알 필요 없음

실제 코드 적용:

```java
public class OrderProcessor {
    private final InventoryService inventoryService;
    private final PaymentService paymentService;

    public OrderResult processOrder(OrderRequest request) {
        inventoryService.reserve(request.getItems());
        paymentService.process(request.getPayment());
        return OrderResult.success();
    }
}
```

### 1.2 역할, 책임, 협력

각 객체는 특정 역할과 책임을 가지며, 인터페이스로 표현한다:

```java
public interface PaymentProcessor {
    PaymentResult process(PaymentRequest request);
}

public interface InventoryManager {
    void reserve(List<OrderItem> items);
    boolean checkAvailability(Product product);
}
```

이렇게 분리하면 단일 책임 원칙과 의존성 역전 원칙을 준수하게 된다.

### 1.3 협력 속에 사는 객체

자율적인 객체는 **상태와 행동을 함께 캡슐화**한다:

```java
public class BankAccount {
    private Money balance;
    private AccountStatus status;

    public WithdrawalResult withdraw(Money amount) {
        if (!canWithdraw(amount)) {
            return WithdrawalResult.failure("출금 불가");
        }
        this.balance = balance.subtract(amount);
        return WithdrawalResult.success();
    }

    private boolean canWithdraw(Money amount) {
        return status.isActive() && balance.isGreaterThanOrEqual(amount);
    }
}
```

메시지와 메서드의 분리로 다형성을 구현:

```java
public interface NotificationSender {
    void send(String message, String recipient);
}

public class EmailSender implements NotificationSender {
    public void send(String message, String recipient) {
        // 이메일 발송
    }
}

public class SmsSender implements NotificationSender {
    public void send(String message, String recipient) {
        // SMS 발송
    }
}
```

### 1.4 객체지향의 본질

객체지향의 핵심은 **클래스가 아닌 협력**이다. 중요한 것은 런타임에 객체들이 어떻게 협력하는가이다.

```java
// 잘못된 접근: 클래스 구조에 집중
class User {
    private String name;
    // getter, setter...
}

// 올바른 접근: 협력과 책임에 집중
public class User {
    public void activate() { ... }
    public boolean canLogin() { ... }
}
```

## 2장: 이상한 나라의 객체

### 2.1 객체지향과 인지 능력

객체지향은 복잡한 시스템을 이해 가능한 객체들의 상호작용으로 분해하여 복잡성을 관리하는 패러다임이다.

### 2.2 객체, 그리고 이상한 나라

**상태를 결정하는 것은 행동이지만, 행동의 결과를 결정하는 것은 상태다.**

앨리스가 버섯을 먹어 키가 변하듯이, 객체의 행동이 상태를 변경하고 상태가 행동 결과에 영향을 준다:

```java
public class GameCharacter {
    private int level;
    private int experience;

    public void gainExperience(int amount) {
        this.experience += amount;
        if (experience >= getRequiredExpForNextLevel()) {
            levelUp(); // 행동이 상태를 변경
        }
    }

    public AttackResult attack(Enemy enemy) {
        int damage = calculateDamage(this.level); // 상태가 행동 결과를 결정
        return enemy.takeDamage(damage);
    }
}
```

### 2.3 객체, 그리고 소프트웨어 나라

객체는 **상태(State)**, **행동(Behavior)**, **식별자(Identity)**로 구성된다:

```java
public class Order {
    // 상태: 속성 + 다른 객체와의 링크
    private OrderId id;
    private OrderStatus status;
    private List<OrderItem> items;

    // 행동: 메시지에 대한 반응
    public void addItem(Product product, int quantity) {
        validateCanAddItem();
        this.items.add(new OrderItem(product, quantity));
        updateTotalAmount();
    }

    // 식별자로 동일성 판단
    @Override
    public boolean equals(Object obj) {
        return obj instanceof Order && id.equals(((Order) obj).id);
    }
}
```

### 2.4 행동이 상태를 결정한다

객체 설계 시 **상태보다 행동에 초점**을 맞춰야 한다:

```java
// 나쁜 예: 상태 중심
public class User {
    private String name;
    private UserStatus status;
    // getter, setter...
}

// 좋은 예: 행동 중심
public class User {
    public void register(Email email) { ... }
    public void activate() { ... }
    public boolean canLogin() { ... }

    // 행동을 지원하는 최소한의 상태만
    private UserStatus status;
}
```

### 2.5 은유와 객체

객체지향의 목적은 **현실 모방이 아닌 새로운 세계 창조**이다. 소프트웨어 객체는 현실보다 더 능동적이고 지능적일 수 있다:

```java
public class SmartContract {
    public void checkAndExecute() {
        if (conditions.areMetAt(LocalDateTime.now())) {
            executeContract(); // 현실의 계약서는 불가능
            distributeRewards();
        }
    }
}
```
